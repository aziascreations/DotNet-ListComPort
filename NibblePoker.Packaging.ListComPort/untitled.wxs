<?xml version="1.0" encoding="utf-8"?>
<?include PlatformDependentVariables.wxi?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="*" Name="$(var.PlatformProductName)" Language="1033" Version="1.0.0.0" Manufacturer="WixEdit" UpgradeCode="$(var.PlatformUpgradeCode)">
		<Package Description="Test file in a Product" Comments="Simple test" InstallerVersion="200" Compressed="yes" Platform="x64" />
		
		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
		
		<Media Id="1" Cabinet="simple.cab" EmbedCab="yes" />
		
		<Icon Id="Icon" SourceFile="..\lscom-v2-text-01.ico" />
		
		<Property Id="ARPPRODUCTICON" Value="Icon" />
		<!--<Property Id="ARPNOREPAIR" Value="yes" Secure="yes" />
		<Property Id="ARPNOMODIFY" Value="yes" Secure="yes" />-->
		
		<WixVariable Id="WixUIBannerBmp" Value="WixUIBannerBmp.png" />
		<WixVariable Id="WixUIDialogBmp" Value="WixUIDialogBmp_thin.png" />
		<WixVariable Id="WixUIExclamationIco" Value="WixUIExclamationIco.png" />
		<WixVariable Id="WixUIInfoIco" Value="WixUIInfoIco.png" />
		<WixVariable Id="WixUINewIco" Value="WixUINewIco.png" />
		<WixVariable Id="WixUIUpIco" Value="WixUIUpIco.png" />
		
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="$(var.PlatformProgramFilesFolder)" Name="PFiles">
				<Directory Id="ORGANIZATIONFOLDER" Name="NibblePoker">
					<Directory Id="INSTALLFOLDER" Name="lscom">
						<Directory Id="LICENSESFOLDER" Name="Licenses"></Directory>
					</Directory>
				</Directory>
			</Directory>
		</Directory>
		
		<ComponentGroup Id="ProductComponentGroup">
			<Component Id="Software" Guid="2b0b66d2-fc39-485b-baee-e5b0da8142a0" Directory="INSTALLFOLDER" Feature="DefaultFeature" Win64="$(var.Win64)">
				<File KeyPath="yes" Source="$(var.FilePathExecutable)" Name="lscom.exe" />
			</Component>
			<Component Id="Licenses" Guid="5aa34a6f-2b5c-4544-8979-a20d6c1d3f3c" Directory="LICENSESFOLDER" Feature="DefaultFeature" Win64="$(var.Win64)">
				<File Source="$(var.FilePathLicense)" Name="NibblePoker.Application.ListComPort.txt" />
				<File Source="$(var.FilePathLicense)" Name="NibblePoker.Library.Arguments.txt" />
				<File Source="$(var.FilePathLicense)" Name="NibblePoker.Library.ComPortHelpers.txt" />
				<File Source="$(var.FilePathLicense)" Name="NibblePoker.Library.RegistryHelpers.txt" />
			</Component>
			<Component Id="Registry" Guid="73b5468a-97b3-4469-a95d-70330ed229e6" Directory="INSTALLFOLDER" Feature="DefaultFeature" Win64="$(var.Win64)">
				<Environment Id="UpdatePath" Name="PATH" Part="last" Action="set" Permanent="yes" System="yes" Value="[INSTALLFOLDER]" />
				<CreateFolder Directory="INSTALLFOLDER" />
			</Component>
		</ComponentGroup>
		
		<Feature Id="DefaultFeature" Title="Main Feature" Level="1" Absent="disallow"></Feature>
		
		<UI Id="UserInterface">
			<Property Id="WIXUI_INSTALLDIR" Value="TARGETDIR" />
			<Property Id="WixUI_Mode" Value="Custom" />
			
			<TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" />
			<TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="9" Bold="yes" />
			<TextStyle Id="WixUI_Font_Title" FaceName="Tahoma" Size="9" Bold="yes" />
			
			<Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />
			
			<DialogRef Id="ErrorDlg" />
			<DialogRef Id="FatalError" />
			<DialogRef Id="FilesInUse" />
			<DialogRef Id="MsiRMFilesInUse" />
			<DialogRef Id="ProgressDlg" />
			<DialogRef Id="PrepareDlg" />
			<DialogRef Id="UserExit" />
			
			<!-- https://qiita.com/tohshima/items/2253710cf82be9a2d386 -->
			
			<Publish Dialog="ExitDialog" Control="Finish" Event="EndDialog" Value="Return" Order="999">1</Publish>
			
			<!-- Welcome -> end message -> install on exit -> install -> end message -->
			<!--<Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="ExitDialog">NOT Installed</Publish>-->
			
			<!-- Welcome -> end dialog -> install -> end message -->
			<Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="CustomizeDlg"></Publish>
			
			<Publish Dialog="CustomizeDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg"></Publish>
			<Publish Dialog="CustomizeDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg"></Publish>
			
			<Publish Dialog="MaintenanceWelcomeDlg" Control="Next" Event="NewDialog" Value="MaintenanceTypeDlg">1</Publish>
			
			<Publish Dialog="MaintenanceTypeDlg" Control="ChangeButton" Event="NewDialog" Value="CustomizeDlg">1</Publish>
			<Publish Dialog="MaintenanceTypeDlg" Control="RepairButton" Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
			<Publish Dialog="MaintenanceTypeDlg" Control="RemoveButton" Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
			<Publish Dialog="MaintenanceTypeDlg" Control="Back" Event="NewDialog" Value="MaintenanceWelcomeDlg">1</Publish>
			
			<Publish Dialog="VerifyReadyDlg" Control="Back" Event="EndDialog" Value="Return"></Publish>
		</UI>
		<UIRef Id="WixUI_Common" />
	</Product>
</Wix>